<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, viewport-fit=cover" />
  <meta name="theme-color" content="#0b0f12" />
  <meta name="color-scheme" content="dark light" />
  <meta name="description" content="Lifeline -- the offline survival guide. One-time $5, no memberships, no tracking." />
  <title>Lifeline -- Offline Survival Guide</title>

  <!-- PWA -->
  <link rel="manifest" href="manifest.json" />
  <link rel="icon" href="images/logo-192.png" sizes="192x192" />
  <link rel="apple-touch-icon" href="images/logo-192.png" />

  <!-- CSS -->
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <!-- Header -->
  <header class="app-header" role="banner">
    <div class="brand">
      <img src="images/logo-192.png" alt="Lifeline logo" class="brand-logo" />
      <div class="brand-text">
        <h1>Lifeline</h1>
        <p class="subtitle">Offline survival & first-aid guide</p>
      </div>
    </div>
    <div id="installBanner" class="install-banner hidden" role="region" aria-live="polite">
      <div class="install-copy">
        <strong>Install Lifeline</strong>
        <span class="muted">Works offline. No tracking.</span>
      </div>
      <div class="install-actions">
        <button id="installBtn" class="btn">Install</button>
        <button id="dismissInstall" class="btn secondary">Not now</button>
      </div>
    </div>
  </header>

  <!-- Navigation Tabs -->
  <nav class="tabs" role="tablist" aria-label="Primary">
    <button role="tab" data-route="home" aria-selected="true">Home</button>
    <button role="tab" data-route="library">Library</button>
    <button role="tab" data-route="tools">Tools</button>
    <button role="tab" data-route="checklists">Checklists</button>
    <button role="tab" data-route="inventory">Inventory</button>
  </nav>

  <!-- Main View -->
  <main id="view" role="main" tabindex="-1" aria-live="polite"></main>

  <!-- Templates -->
  <!-- HOME -->
  <template id="tpl-home">
    <section class="hero">
      <div class="hero-text">
        <h2>Be Ready in 60 Seconds</h2>
        <p class="muted">Fast access to survival, first aid, and readiness -- works offline, no signal required.</p>
      </div>
      <div class="quick-actions">
        <a href="#library" class="qa-btn">📚 <span>Library</span></a>
        <a href="#tools" class="qa-btn">🧰 <span>Tools</span></a>
        <a href="#checklists" class="qa-btn">✅ <span>Checklists</span></a>
        <a href="#inventory" class="qa-btn">📦 <span>Inventory</span></a>
      </div>
      <ul class="badges">
        <li>🛰 Offline</li>
        <li>🕵 No Tracking</li>
        <li>💵 One-Time $5</li>
      </ul>
    </section>

    <section class="section" aria-labelledby="search-guides">
      <h2 id="search-guides">Search the Guide</h2>
      <input id="homeSearch" type="search" placeholder="Try 'hypothermia', 'fire', 'water'…" aria-label="Search guides" />
      <ul class="list" id="homeSearchResults" hidden></ul>
    </section>
  </template>

  <!-- LIBRARY -->
  <template id="tpl-library">
    <section class="section" aria-labelledby="library-title">
      <h2 id="library-title">Survival Library</h2>
      <ul id="guideList" class="list"></ul>
    </section>
    <section id="guideReader" class="section hidden">
      <button class="backBtn" data-back="library">← Back</button>
      <article id="guideContent" class="markdown"></article>
    </section>
  </template>

  <!-- TOOLS -->
  <template id="tpl-tools">
    <section class="section" aria-labelledby="tools-title">
      <h2 id="tools-title">Tools</h2>
      <div class="cards">
        <a class="card" href="#tools/compass">🧭 Compass</a>
        <a class="card" href="#tools/sos">🚨 SOS & Morse</a>
        <a class="card" href="#tools/knots">🪢 Knot Guide</a>
        <a class="card" href="#tools/convert">🔁 Unit Converter</a>
        <a class="card" href="#tools/map">🗺️ Map Snapshot</a>
      </div>
      <section id="toolView" class="section"></section>
    </section>
  </template>

  <!-- CHECKLISTS -->
  <template id="tpl-checklists">
    <section class="section" aria-labelledby="checklists-title">
      <h2 id="checklists-title">Checklists</h2>
      <ul id="checklistList" class="list"></ul>
      <button id="addChecklistBtn" class="btn">+ New Checklist</button>
    </section>
    <section id="checklistEditor" class="section hidden">
      <button class="backBtn" data-back="checklists">← Back</button>
      <h3 id="checklistTitle"></h3>
      <ul id="checklistItems" class="list"></ul>
      <div class="row">
        <input id="newItemText" placeholder="Add item…" />
        <button id="addItemBtn" class="btn">Add</button>
      </div>
      <button id="exportChecklistBtn" class="btn secondary">Export as Text</button>
    </section>
  </template>

  <!-- INVENTORY -->
  <template id="tpl-inventory">
    <section class="section" aria-labelledby="inventory-title">
      <h2 id="inventory-title">Supplies Inventory</h2>
      <div class="row">
        <input id="invName" placeholder="Item name" />
        <input id="invQty" type="number" min="0" placeholder="Qty" />
        <input id="invCat" placeholder="Category" />
        <button id="invAddBtn" class="btn">Add</button>
      </div>
      <ul id="invList" class="list"></ul>
      <div class="row">
        <button id="invExportBtn" class="btn secondary">Export CSV</button>
        <button id="invClearBtn" class="btn danger">Clear All</button>
      </div>
    </section>
  </template>

  <!-- App Logic -->
  <script src="app.js" defer></script>
  <script>
    if ("serviceWorker" in navigator) {
      window.addEventListener("load", () => {
        navigator.serviceWorker.register("./sw.js").catch(() => {});
      });
    }
  </script>
</body>
</html>