<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta
    name="viewport"
    content="width=device-width, initial-scale=1, maximum-scale=1, viewport-fit=cover"
  />
  <meta name="theme-color" content="#0b0f12" />
  <meta name="color-scheme" content="dark light" />
  <meta name="description" content="Survive -- the offline survival guide. One-time $5, no memberships, no tracking." />
  <title>Survive -- Offline</title>

  <!-- Icons / PWA -->
  <link rel="manifest" href="manifest.json" />
  <link rel="icon" href="images/logo-192.png" sizes="192x192" />
  <link rel="apple-touch-icon" href="images/logo-192.png" />

  <!-- CSS (preload for faster paint) -->
  <link rel="preload" href="styles.css" as="style" />
  <link rel="stylesheet" href="styles.css" />

  <!-- Prevent flash of unstyled content in very old browsers -->
  <noscript><style>body{opacity:1}</style></noscript>
</head>
<body>
  <!-- Header -->
  <header class="app-header" role="banner">
    <h1 aria-label="Survive -- Offline Survival Guide">Survive</h1>
    <p class="subtitle">The offline survival guide</p>
  </header>

  <!-- Primary nav -->
  <nav class="tabs" role="tablist" aria-label="Primary">
    <button role="tab" aria-selected="true" data-route="home" class="active">Home</button>
    <button role="tab" data-route="library">Library</button>
    <button role="tab" data-route="tools">Tools</button>
    <button role="tab" data-route="checklists">Checklists</button>
    <button role="tab" data-route="inventory">Inventory</button>
  </nav>

  <!-- Main view -->
  <main id="view" role="main" tabindex="-1" aria-live="polite"></main>

  <!-- Templates (rendered by app.js) -->
  <template id="tpl-home">
    <section class="section" aria-labelledby="quick-start">
      <h2 id="quick-start">Quick Start</h2>
      <div class="cards" role="list">
        <a class="card" href="#library" role="listitem" aria-label="Open Survival Library">📚 Survival Library</a>
        <a class="card" href="#tools" role="listitem" aria-label="Open Tools">🧭 Tools</a>
        <a class="card" href="#checklists" role="listitem" aria-label="Open Checklists">📝 Checklists</a>
        <a class="card" href="#inventory" role="listitem" aria-label="Open Supplies Inventory">📦 Supplies</a>
      </div>
      <p class="muted">Everything works offline after the first load.</p>
    </section>

    <section class="section" aria-labelledby="popular-guides">
      <h2 id="popular-guides">Popular Guides</h2>
      <ul class="list" id="popularGuides" aria-live="polite"></ul>
    </section>
  </template>

  <template id="tpl-library">
    <section class="section" aria-labelledby="library-title">
      <h2 id="library-title">Survival Library</h2>
      <ul id="guideList" class="list"></ul>
    </section>

    <section id="guideReader" class="section hidden" aria-labelledby="guide-heading">
      <button class="backBtn" data-back="library" aria-label="Back to Library">← Back</button>
      <article id="guideContent" class="markdown" aria-live="polite"></article>
    </section>
  </template>

  <template id="tpl-tools">
    <section class="section" aria-labelledby="tools-title">
      <h2 id="tools-title">Tools</h2>
      <div class="cards" role="list">
        <a class="card" href="#tools/compass" role="listitem">🧭 Compass</a>
        <a class="card" href="#tools/sos" role="listitem">🚨 SOS &amp; Morse</a>
        <a class="card" href="#tools/knots" role="listitem">🪢 Knot Guide</a>
        <a class="card" href="#tools/convert" role="listitem">🔁 Unit Converter</a>
        <a class="card" href="#tools/map" role="listitem">🗺️ Map Snapshot (Offline)</a>
      </div>
    </section>
    <section id="toolView" class="section" aria-live="polite"></section>
  </template>

  <template id="tpl-checklists">
    <section class="section" aria-labelledby="checklists-title">
      <h2 id="checklists-title">Checklists</h2>
      <ul id="checklistList" class="list"></ul>
      <button id="addChecklistBtn" class="btn" aria-label="Create New Checklist">+ New Checklist</button>
    </section>

    <section id="checklistEditor" class="section hidden" aria-labelledby="checklistTitle">
      <button class="backBtn" data-back="checklists" aria-label="Back to Checklists">← Back</button>
      <h3 id="checklistTitle"></h3>
      <ul id="checklistItems" class="list"></ul>
      <div class="row">
        <input id="newItemText" placeholder="Add item…" aria-label="Checklist item text" />
        <button id="addItemBtn" class="btn">Add</button>
      </div>
      <button id="exportChecklistBtn" class="btn secondary">Export as Text</button>
    </section>
  </template>

  <template id="tpl-inventory">
    <section class="section" aria-labelledby="inventory-title">
      <h2 id="inventory-title">Supplies Inventory</h2>
      <div class="row">
        <input id="invName" placeholder="Item (e.g., Water)" aria-label="Item name" />
        <input id="invQty" type="number" min="0" placeholder="Qty" aria-label="Quantity" />
        <input id="invCat" placeholder="Category" aria-label="Category" />
        <button id="invAddBtn" class="btn">Add</button>
      </div>
      <ul id="invList" class="list"></ul>
      <div class="row">
        <button id="invExportBtn" class="btn secondary">Export CSV</button>
        <button id="invClearBtn" class="btn danger">Clear All</button>
      </div>
    </section>
  </template>

  <!-- App -->
  <script src="app.js" defer></script>
  <script>
    if ("serviceWorker" in navigator) {
      window.addEventListener("load", () => {
        navigator.serviceWorker.register("./sw.js").catch(() => {});
      });
    }
  </script>
</body>
</html>